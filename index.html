<html>

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Aeon's End Turn Order Assistant</title>
<link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>
<div id = "buttons">
<button class = "button" onclick="buttonPress(1)"> Solo </button>
<button class = "button" onclick="buttonPress(2)"> Two players </button>
<button class = "button" onclick="buttonPress(3)"> Three players </button>
<button class = "button" onclick="buttonPress(4)"> Four players </button>
</div>
<br>
<div id = "turnDeck">
	<img src ="images/cardBack.jpg" id = "deck" onclick="takeTurn()" width = "420px"/>
	<br>
</div>
<!--
<div id = "revealedCards">
	<img id = "card1" width = 15%/>
	<img id = "card2" width = 15%/>
	<img id = "card3" width = 15%/>
	<img id = "card4" width = 15%/>
	<img id = "card5" width = 15%/>
	<img id = "card6" width = 15%/>
</div>
-->
<div id = "scaling">
<img src ="images/discard/p1.jpg" id = "card1" onclick="shuffleOne(0)" width = "300px">
<img src ="images/discard/p2.jpg" id = "card2" onclick="shuffleOne(1)" width = "300px">
<img src ="images/discard/p3.jpg" id = "card3" onclick="shuffleOne(2)" width = "300px">
<img src ="images/discard/p4.jpg" id = "card4" onclick="shuffleOne(3)" width = "300px">
<img src ="images/discard/nemesis.jpg" id = "card5" onclick="shuffleOne(4)" width = "300px">
<img src ="images/discard/nemesis.jpg" id = "card6" onclick="shuffleOne(5)" width = "300px">
</div>
<br>
<div id = "revealButton">
<button class = "button" onClick="revealTop()"> Reveal top </button>
<button class = "button" onClick="putBottom()"> Put top on bottom </button>
<button class = "button" onClick="resetDeck()"> Shuffle Deck </button>
</div>
</body>
<!--<p id = "roundNum"> Current Round: 0 </p>-->

<script src ="Underscore.js" type="text/javascript">
</script>

<script type = "text/javascript">

turnDeck = [];
turnDiscard = [];
//roundNum = 1;
currentCard = 1;

function buttonPress(numPlayers){
	if (numPlayers==1){
		turnDeck = ["p1","p1","p1","nemesis","nemesis"];
		};
	if (numPlayers==2){
		turnDeck = ["p1", "p2", "p1", "p2", "nemesis", "nemesis"];
	};
	if (numPlayers==3){
		turnDeck = ["p1", "p2", "p3", "wild", "nemesis", "nemesis"]
	};
	if (numPlayers==4){
		turnDeck = ["p1", "p2", "p3", "p4", "nemesis", "nemesis"]
		
	};
	turnDiscard = [];
	shuffle();
	showBack();
	hide();
	//roundNum = 1;
	currentCard = 1;
	//setRoundNum();
}

shuffle = function(){
	//console.log(turnDeck);
	turnDeck = _.shuffle(turnDeck);
	//console.log(turnDeck);
}

//setRoundNum = function(){
//	document.getElementById("roundNum").innerHTML = "Current Round: " + roundNum;
//}

takeTurn = function(){
	//console.log(turnDeck[0]);
	console.log(turnDeck);
	//console.log(currentCard);
	if (turnDeck.length == 0){
		resetDeck();
		//roundNum = roundNum+1;
		//setRoundNum();
	}
	document.getElementById("card" + currentCard).style.visibility="visible";
	turnDiscard.push(turnDeck.shift());
	currentLen = turnDiscard.length;
	document.getElementById("card" + currentCard).src="images/discard/" + turnDiscard[currentLen-1] + ".jpg";
	currentCard = currentCard + 1;
	if (turnDeck.length == 0){
		document.getElementById("deck").src="images/empty.jpg";
	}
	else {
		showBack();
	}
}
        
resetDeck = function(){
        while (turnDiscard.length > 0){
				console.log(turnDeck)
                turnDeck.push(turnDiscard.shift());
		}
		shuffle();
		hide();
		currentCard = 1;
		showBack();
}

revealTop = function(){
	if (turnDeck.length == 0){
		resetDeck();
	}
	document.getElementById("deck").src="images/" + turnDeck[0] + ".jpg";
}

putBottom = function(){
	if (turnDeck.length == 0){
		resetDeck();
	}
	turnDeck.push(turnDeck.shift());
	showBack();
};

showBack = function(){
	document.getElementById("deck").src="images/cardBack.jpg";
}

hide = function(){
	document.getElementById("card1").style.visibility="hidden";
	document.getElementById("card2").style.visibility="hidden";
	document.getElementById("card3").style.visibility="hidden";
	document.getElementById("card4").style.visibility="hidden";
	document.getElementById("card5").style.visibility="hidden";
	document.getElementById("card6").style.visibility="hidden";
}

shuffleOne = function(i){
	spliced = turnDiscard.splice(i,1);
	console.log(i);
	console.log(turnDiscard);
	console.log(spliced);
	turnDeck.push(spliced[0])
	console.log(turnDeck);
	shuffle();
	hide();
	for(j = 1; j < turnDiscard.length+1; j++){
		document.getElementById("card" + j).style.visibility="visible";
		document.getElementById("card" + j).src="images/discard/" + turnDiscard[j-1] + ".jpg";
		
	}
	currentCard = currentCard - 1;
	showBack();
}

window.onload = function() {
	buttonPress(2);
};
</script>

</html>
